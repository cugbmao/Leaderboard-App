<link rel="import" href="../../bower_components/polymer/polymer.html">

<polymer-element name="leaderboard-clubhouse" attributes="upcomingTournaments wide">
  <template>
    <link rel="stylesheet" href="leaderboard-clubhouse.css">
    <div id="sectionPanel" class="section-panel {{ {wide: wide} | tokenList }}"
         flex vertical layout?="{{!wide}}">

      <div class="background-fade  background-fade--themed"
           fit
           cross-fade></div>

      <div class="card" flex?="{{!wide}}" vertical layout?="{{!wide}}" hero-p>

        <core-toolbar class="menu-toolbar" hero-id="clubhouse-title" hero>

          <div class="section-title" flex cross-fade-delayed>Submit Cards</div>

        </core-toolbar>

        <div id="sectionContent"
             class="section-content"
             flex
             hero-id="clubhouse-background"
             hero="{{!wide}}">

          <core-animated-pages class="club-house-pages"
                               selected="{{selected}}"
                               transitions="slide-from-right"
                               auto>

            <leaderboard-submit-cards id="submitCards"
                                      class="submit-cards-view"
                                      name="submitCards"
                                      activeTournament="{{activeTournament}}">
            </leaderboard-submit-card>

          </core-animated-pages>

        </div>

        <paper-fab class="fab-button"
                   icon="{{icon}}"></paper-fab>

      </div>

      <paper-icon-button class="back-button"
                         icon="arrow-back"
                         on-tap="{{backNavigation}}"
                         hero-id="clubhouse-back-button"
                         hero>
      </paper-icon-button>

      <paper-icon-button class="home-button"
                         icon="home"
                         on-tap="{{homeNavigation}}"
                         cross-fade>
      </paper-icon-button>

    </div>
  </template>
  <script>
    (function () {

      Polymer({

        // List of tournaments the user is associated with
        upcomingTournaments: null,

        // Tournament that is currently active
        activeTournament: null,

        // Set activeTournament based on upcomingTournaments collection
        // ToDo - upcomingTournaments firebase element is in score-round. Should probably be at app level
        upcomingTournamentsChanged: function() {

          if (this.upcomingTournaments) {

            this.upcomingTournaments.forEach(function(tournament) {
              if (tournament.status === 'active') {
                this.activeTournament = tournament;
              }
            }, this);
          }
        },

        backNavigation: function() {
            window.history.back();
        },

        // Handler for home button in toolbar. If on top level route, go straight to menu. Otherwise go back to top level
        // route and then go back to menu as deep routes won't be recognised in parent core animated pages element
        homeNavigation: function() {
          window.location.hash = 'menu';
        }
      });

    })();
  </script>
</polymer-element>
