<polymer-element fit layout vertical name="leaderboard-app" attributes="user userDetails">

    <template>

        <link rel="stylesheet" href="leaderboard-app.css">

        <core-style ref="card--primary"></core-style>

        <flatiron-director route="{{route}}" autoHash></flatiron-director>

        <core-animated-pages
          valueattr="hash"
          id="coreAnimatedPages"
          selected="{{route}}"
          transitions="cross-fade slide-down tile-cascade slide-up slide-up-offscreen hero-transition"
          flex
          auto>

          <leaderboard-menu hash="menu" userDetails="{{userDetails}}" wide="{{wide}}"
                            section="{{section}}" on-core-activate="{{sectionSelect}}">
          </leaderboard-menu>

          <leaderboard-tournament hash="tournament" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-tournament>

          <leaderboard-scorecard hash="scorecard" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-scorecard>

          <leaderboard-scoreboard hash="scoreboard" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-scoreboard>

          <leaderboard-clubhouse hash="clubhouse" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-clubhouse>

          <leaderboard-stats hash="stats" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-stats>

          <leaderboard-results hash="results" userDetails="{{userDetails}}" wide="{{wide}}" vertical layout>
          </leaderboard-results>

          <leaderboard-course-information hash="courseinformation" userDetails="{{userDetails}}" wide="{{wide}}"
                                          vertical layout>
          </leaderboard-course-information>

          <leaderboard-authentication hash="profile" userDetails="{{userDetails}}" user="{{user}}"
                                      statusKnown="{{statusKnown}}" wide="{{wide}}" layout center vertical
                                      on-user-logged-in="{{ enterSite }}"
                                      on-user-logged-out="{{ enterAuthentication }}"
                                      on-profile-changed="{{ enterSite }}">
          </leaderboard-authentication>

        </core-animated-pages>

        <core-media-query query="min-width: {{responsiveWidth}}" queryMatches="{{wide}}"></core-media-query>

    </template>

    <script>
        (function () {
            'use strict';

            Polymer({

              responsiveWidth: '900px',

              // Set default hash to authentication if no hash specified in URL
              ready: function() {
                this.route = this.route || 'profile';
              },

              // Triggered when user logged out to force users to authentication
              enterAuthentication: function() {
                this.route = 'profile';
              },

              // Triggered when user logged in. If route isn't for authentication take them to the hash specified in URL
              // Otherwise go to the menu.
              enterSite: function() {
                if (this.route !== 'profile') {
                  this.route = this.route;
                } else {
                  this.route = 'menu';
                }
              },

              sectionSelect: function() {

                var sectionName;

                if (this.section) {
                  sectionName = this.section.name;
                  this.route = sectionName;
                }
              }
            });

        })();
    </script>

</polymer-element>
