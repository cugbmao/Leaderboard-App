<link rel="import" href="../../bower_components/polymer/polymer.html">

<polymer-element name="leaderboard-create-user" attributes="userDetails email password name handicap">
  <template>
    <link rel="stylesheet" href="leaderboard-create-user.css">

    <paper-input-decorator id="email" error="Please enter a valid email address"
                           floatingLabel label="Email">
      <input id="email_input" is="core-input" type="email" on-keyup="{{ validate }}"
             value="{{email}}" required>
    </paper-input-decorator>
    <paper-input-decorator id="password" error="Password is required"
                           floatingLabel label="Password">
      <input id="password_input" is="core-input" type="password" on-keyup="{{ validate }}"
             value="{{password}}" required>
    </paper-input-decorator>
    <paper-input label="Name (optional)" floatinglabel value="{{name}}"
                 type="name" id="name_input" layout vertical>
    </paper-input>
    <paper-input label="Handicap (optional)" floatinglabel value="{{handicap}}"
                 type="handicap" id="handicap_input" layout vertical>
    </paper-input>
    <div class="button-holder" horizontal center layout>
      <div flex></div>
      <paper-fab id="CreateUserButton" icon="check"
                 showing?="{{ showFab }}"
                 on-tap="{{ createUser }}"
      </paper-fab>
    </div>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({

        showFab: false,

        validate: function(event, detail, sender) {

          var emailDecorator = this.$.email;
          var passwordDecorator = this.$.password;
          var emailInput = this.$.email_input;
          var passwordnput = this.$.password_input;

          emailDecorator.isInvalid = !emailInput.validity.valid;
          passwordDecorator.isInvalid = !passwordnput.validity.valid;

          // Show Fab button is email and password are valid
          if (emailInput.validity.valid && passwordnput.validity.valid) {
            this.showFab = true;
          } else {
            this.showFab = false;
          }
        },

        // Assign values to published 'userDetails' object.
        createUser: function() {

          // Focus on the fab button otherwise some mobile devices don't seem to pick up the change to the paper input
          // value in time so the value doesn't get updated correctly below.
          this.$.CreateUserButton.focus();

          this.userDetails = {
            email: this.email,
            password: this.password,
            name: this.name,
            handicap: this.handicap
          };

          this.fire('create-user-button-pressed');
        }
      });

    })();
  </script>
</polymer-element>
