<link rel="import" href="../../bower_components/polymer/polymer.html">

<polymer-element name="leaderboard-create-group"
                 attributes="roundToScore tournamentToScore tournamentPlayers tournamentPlayersLength groupTournamentScore">
  <template>
    <link rel="stylesheet" href="leaderboard-create-group.css">

    <section id="createGroupSection"
             class="create-group-section  {{ {wide: wide} | tokenList }}"
             layout vertical>

      <core-list id="availablePlayersList"
                 class='available-players-list'
                 data="{{availablePlayers}}"
                 on-core-activate="{{playerSelected}}"
                 flex>
        <template>
          <div class="players-list__row {{ {selected: selected} | tokenList }}">
            <div class="players-list__item">
              <div class="player-name">{{model.name}}</div>
              <div class="player-handicap">{{model.handicap}}</div>
            </div>
            <div class="divider">
            </div>
        </template>
      </core-list>

      <div>{{tournamentToScore.name}}</div>
      <div>{{roundToScore.venue}}</div>
      {{tournamentPlayersLength}}

    </section>

  </template>
  <script>
    (function () {
      'use strict';

      Polymer({

        availablePlayers: [],

        tournamentPlayersLength: 0,

        // When tournamentPlayers array has finished populating
        tournamentPlayersChanged: function() {
          if (this.tournamentPlayersLength === this.tournamentPlayers.length) {
            this.getAvailablePlayers();
          }
        },

        // Iterate the player ids of tournamentPlayers and if they exist in any of the groupings collection property in
        // the players collection, set the availablePlayers array
        getAvailablePlayers: function() {

          if (this.roundToScore && this.roundToScore.groupings) {
            this.tournamentPlayers.forEach(function(player) {
              this.addAvailablePlayer(player.uid);
            }, this);
          } else {
            this.availablePlayers = this.tournamentPlayers;
          }
        },

        // If player doesn't already exist in a grouping, add them to availablePlayers array
        addAvailablePlayer: function(playerId) {

          if (this.roundToScore.groupings.players) {
            console.log(this.roundToScore.groupings.players);
          }

        }

      });

    })();
  </script>
</polymer-element>
